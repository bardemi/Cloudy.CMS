@using Microsoft.Extensions.Configuration
@using Cloudy.CMS.Naming
@using System.Reflection
@inject IConfiguration Configuration
@inject IHumanizer Humanizer

@{
    var viteBaseUri = Configuration["ViteBaseUri"]?.TrimEnd('/');
}

<!doctype html>
<html>
    <head>
        <title>@Humanizer.Humanize(Assembly.GetEntryAssembly().GetName().Name)</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>
        @if(viteBaseUri == null){
            <link href="/_content/Cloudy.CMS.UI/index.css" rel="stylesheet">
        }
        else
        {
            <script type="module" src="@viteBaseUri/@@vite/client"></script>
        }
    </head>
    <body>
        @RenderBody()
        @if (viteBaseUri == null)
        {
            <script async type="module" crossorigin src="/_content/Cloudy.CMS.UI/index.bundle.js"></script>
        }
        else
        {
            <script type="module" src="@viteBaseUri/main.jsx"></script>
            <script>
                window.addEventListener('load', () => {
                    if(!window.viteIsLoaded){
                        document.write('<div class="alert alert-primary" style="position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); width: 500px; max-width: 80vw; box-shadow: rgba(255, 255, 255, 0.75) 0 0 0 5px;"><h2>Vite is configured but not started.</h2><p class="mb-0">Please go to <code>wwwroot-src/</code> and <code>npm run dev</code></p></div>')
                    }
                });
            </script>
        }
    </body>
</html>